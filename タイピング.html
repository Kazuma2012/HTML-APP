
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>タイピング</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #222;
      color: #fff;
      text-align: center;
      padding-top: 50px;
      overflow: hidden;
      transition: background-color 0.3s;
    }
    #word {
      font-size: 48px;
      margin: 20px;
    }
    #romaji {
      font-size: 24px;
      margin-bottom: 10px;
      letter-spacing: 5px;
    }
    #romaji .typed {
      color: #555;
    }
    #romaji .untyped {
      color: lightgreen;
    }
    #input {
      font-size: 24px;
      padding: 10px;
      width: 300px;
    }
    #score, #high-score, #timer {
      font-size: 20px;
      margin-top: 10px;
    }
    #start-btn {
      margin-top: 20px;
      padding: 10px 30px;
      font-size: 20px;
      background-color: #00bcd4;
      color: white;
      border: none;
      cursor: pointer;
    }
    #start-btn:hover {
      background-color: #0097a7;
    }

    /* 🔽 追加部分：右上固定リセットボタンとモーダルのスタイル */

    #reset-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 8px 16px;
      font-size: 14px;
      background-color: #f44336;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 6px;
    }
    #reset-btn:hover {
      background-color: #d32f2f;
    }

    #modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .modal-content {
      background: #333;
      color: #fff;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      width: 300px;
    }

    .modal-buttons {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
    }

    .modal-buttons button {
      padding: 8px 16px;
      font-size: 14px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .cancel-btn {
      background-color: #777;
      color: white;
    }
    .cancel-btn:hover {
      background-color: #555;
    }

    .confirm-btn {
      background-color: #f44336;
      color: white;
    }
    .confirm-btn:hover {
      background-color: #d32f2f;
    }
  </style>
</head>
<body>
  <h1>タイピング</h1>

  <!-- 🔽 右上に配置されたリセットボタン -->
  <button id="reset-btn">最高記録リセット</button>

  <div id="word">スタートを押してね！</div>
  <div id="romaji"></div>
  <input type="text" id="input" disabled placeholder="ここに1文字ずつ入力！" autocomplete="off" />
  <div id="score">スコア: 0</div>
  <div id="high-score">最高記録: 0</div>
  <div id="timer">60秒</div>
  <button id="start-btn">スタート</button>

  <!-- 🔽 モーダルウィンドウ（初期は非表示） -->
  <div id="modal">
    <div class="modal-content">
      <p>本当に最高記録をリセットしますか？</p>
      <div class="modal-buttons">
        <button class="cancel-btn" id="cancel-reset">キャンセル</button>
        <button class="confirm-btn" id="confirm-reset">リセット</button>
      </div>
    </div>
  </div>

  <script>
      const words = [
  { word: "こんにちは", romaji: "konnitiha" },
  { word: "ありがとう", romaji: "arigatou" },
  { word: "さようなら", romaji: "sayounara" },
  { word: "すし", romaji: "susi" },
  { word: "ねこ", romaji: "neko" },
  { word: "がっこう", romaji: "gakkou" },
  { word: "てんき", romaji: "tenki" },
  { word: "でんしゃ", romaji: "densya" },
  { word: "ともだち", romaji: "tomodati" },
  { word: "あさごはん", romaji: "asagohan" },
  { word: "経済", romaji: "keizai" },
  { word: "哲学", romaji: "tetugaku" },
  { word: "環境問題", romaji: "kankyomondai" },
  { word: "情報技術", romaji: "jouhougijutu" },
  { word: "人工知能", romaji: "zinkoutinou" },
  { word: "国際関係", romaji: "kokusaikankei" },
  { word: "持続可能", romaji: "jizokukanou" },
  { word: "多様性", romaji: "tayousei" },
  { word: "責任感", romaji: "sekininkan" },
  { word: "創造力", romaji: "souzouryoku" },
  { word: "独立心", romaji: "dokuritusin" },
  { word: "協調性", romaji: "kyoutyousei" },
  { word: "論理的思考", romaji: "ronritekisikou" },
  { word: "観察力", romaji: "kansatsuryoku" },
  { word: "自己管理", romaji: "zikokanri" },
  { word: "目標設定", romaji: "mokuhyousettei" },
  { word: "時間割", romaji: "jikanwari" },
  { word: "歴史的背景", romaji: "rekisitekihaikei" },
  { word: "因果関係", romaji: "ingakankei" },
  { word: "地球温暖化", romaji: "tikyuondanka" },
  { word: "文化交流", romaji: "bunkakouryuu" },
  { word: "予測不能", romaji: "yosokuhunou" },
  { word: "視野拡大", romaji: "siyakakudai" },
  { word: "分析能力", romaji: "bunsekiryoku" },
  { word: "学習意欲", romaji: "gakusuiyoku" },
  { word: "倫理観", romaji: "rinrikan" },
  { word: "多国籍企業", romaji: "takokusekikigyou" },
  { word: "翻訳技術", romaji: "honyakugijutu" },
  { word: "心理的影響", romaji: "sinritekieikyou" },
  { word: "人工衛星", romaji: "zinkoueisei" },
  { word: "お金もち", romaji: "okanemoti" },
  { word: "心の中", romaji: "kokorononaka" },
  { word: "未来へのゆめ", romaji: "miraihenoyume" },
  { word: "小さなしあわせ", romaji: "tiisanasiawase" },
  { word: "ふしぎな力", romaji: "husiginatikara" },
  { word: "時間の使い方", romaji: "jikannotsukaikata" },
  { word: "毎日の生活", romaji: "mainitinosikatu" },
  { word: "朝の光", romaji: "asanohikari" },
  { word: "学びの道", romaji: "manabinomiti" },
  { word: "やさしい言葉", romaji: "yasasiikotoba" },
  { word: "正しい判断", romaji: "tadasiihandan" },
  { word: "ひとつの選択", romaji: "hitotunosentaku" },
  { word: "前向きな心", romaji: "maemukinakokoro" },
  { word: "努力のあしあと", romaji: "doryokunoasiato" },
  { word: "成長する自分", romaji: "seityousurujibun" },
  { word: "いのちの大切さ", romaji: "inotinotaisetusa" },
  { word: "家族のぬくもり", romaji: "kazokunonukumori" },
  { word: "目に見えない力", romaji: "meninienaitikara" },
  { word: "自然とともに", romaji: "sizentotomoni" },
  { word: "今日という一日", romaji: "kyoutoiuitiniti" },
  { word: "夢にむかって", romaji: "yumenimukatte" },
  { word: "本当の気持ち", romaji: "hontounokimoti" },
  { word: "あきらめない心", romaji: "akiramenaikokoro" },
  { word: "見えない未来", romaji: "mienaimirai" },
  { word: "希望の光", romaji: "kibounohikari" },
  { word: "静かな夜", romaji: "sizukanayoru" },
  { word: "信じる力", romaji: "sinzirutikara" },
  { word: "広い世界", romaji: "hiroisekai" },
  { word: "なみだの理由", romaji: "namidanoriyuu" },
  { word: "心のメロディー", romaji: "kokoronomerodii" },
  { word: "静けさの中", romaji: "sizukesanonaka" },
  { word: "信じたい気持ち", romaji: "sinzitaikimoti" },
  { word: "心をつなぐ", romaji: "kokorowotunagu" },
  { word: "朝日のぬくもり", romaji: "asahinonukumori" },
  { word: "過ぎ去った時間", romaji: "sugisattajikan" },
  { word: "笑顔の理由", romaji: "egaonoriyuu" },
  { word: "未来への一歩", romaji: "miraihenoippo" },
  { word: "風のささやき", romaji: "kazenosasayaki" },
  { word: "ゆめの続き", romaji: "yumenotuzuki" },
  { word: "ふたりの約束", romaji: "hutarinoyakusoku" },
  { word: "涙がこぼれる", romaji: "namidagakoboreru" },
  { word: "目をとじれば", romaji: "mewotojireba" },
  { word: "心にひびく", romaji: "kokoronihibiku" },
  { word: "消えない思い出", romaji: "kienaiomoide" },
  { word: "ゆれる気持ち", romaji: "yurerukimoti" },
  { word: "終わらない物語", romaji: "owaranaimonogatari" },
  { word: "だれかのために", romaji: "darekanotameni" },
  { word: "遠くの空", romaji: "tookunosora" },
  { word: "迷いの中で", romaji: "mayoinonakade" },
  { word: "ふりかえった道", romaji: "hurikaettamiti" },
  { word: "深い眠り", romaji: "hukainemuri" },
  { word: "光と影", romaji: "hikaritokage" },
  { word: "そっと手をにぎる", romaji: "sottotewonigiru" },
  { word: "願いをこめて", romaji: "negaiwokomete" },
  { word: "大切な時間", romaji: "taisetunajikan" },
  { word: "歩み続ける", romaji: "ayumitudukeru" },
  { word: "心の宝物", romaji: "kokoronotakaramono" },
  { word: "はじまりの朝", romaji: "hazimarinoasa" }
];


    let score = 0;
    let highScore = localStorage.getItem("highScore") || 0;
    let currentWord = "";
    let currentRomaji = "";
    let inputIndex = 0;
    let timer = 60;
    let timerInterval;
    let usedWords = [];

    const wordElement = document.getElementById("word");
    const romajiElement = document.getElementById("romaji");
    const inputElement = document.getElementById("input");
    const scoreElement = document.getElementById("score");
    const highScoreElement = document.getElementById("high-score");
    const timerElement = document.getElementById("timer");
    const startBtn = document.getElementById("start-btn");

    // 🔽 モーダル処理に必要な要素を取得
    const resetBtn = document.getElementById("reset-btn");
    const modal = document.getElementById("modal");
    const cancelReset = document.getElementById("cancel-reset");
    const confirmReset = document.getElementById("confirm-reset");

    resetBtn.addEventListener("click", () => {
      modal.style.display = "flex";
    });

    cancelReset.addEventListener("click", () => {
      modal.style.display = "none";
    });

    confirmReset.addEventListener("click", () => {
      localStorage.removeItem("highScore");
      highScore = 0;
      highScoreElement.textContent = `最高記録: 0`;
      modal.style.display = "none";
      alert("最高記録をリセットしたよ！🧼✨");
    });

    function getRandomWord() {
      const unused = words.filter(w => !usedWords.includes(w.word));
      if (unused.length === 0) {
        clearInterval(timerInterval);
        alert("すべての言葉をクリアしたよ！💪");
        inputElement.disabled = true;
        return { word: "完全勝利！", romaji: "" };
      }
      const index = Math.floor(Math.random() * unused.length);
      const word = unused[index];
      usedWords.push(word.word);
      return word;
    }

    function displayWord() {
      const wordObj = getRandomWord();
      currentWord = wordObj.word;
      currentRomaji = wordObj.romaji;
      inputIndex = 0;
      wordElement.textContent = currentWord;
      updateRomajiDisplay();
    }

    function updateRomajiDisplay() {
      romajiElement.innerHTML = "ローマ字: ";
      for (let i = 0; i < currentRomaji.length; i++) {
        const span = document.createElement("span");
        span.textContent = currentRomaji[i];
        span.className = i < inputIndex ? "typed" : "untyped";
        romajiElement.appendChild(span);
      }
    }

    function updateTimer() {
      timer--;
      timerElement.textContent = `${timer}秒`;
      if (timer <= 0) {
        clearInterval(timerInterval);
        inputElement.disabled = true;
        if (score > highScore) {
          highScore = score;
          localStorage.setItem("highScore", highScore);
        }
        highScoreElement.textContent = `最高記録: ${highScore}`;
        alert(`時間切れ！スコアは ${score} 点だったよ！🎉`);
      }
    }

    function startGame() {
      score = 0;
      timer = 60;
      usedWords = [];
      scoreElement.textContent = "スコア: 0";
      highScoreElement.textContent = `最高記録: ${highScore}`;
      timerElement.textContent = `${timer}秒`;
      inputElement.disabled = false;
      inputElement.value = "";
      inputElement.focus();
      displayWord();
      clearInterval(timerInterval);
      timerInterval = setInterval(updateTimer, 1000);
    }

    function startCountdownAndGame() {
      let count = 3;
      wordElement.textContent = `${count}`;
      romajiElement.textContent = "";
      inputElement.disabled = true;
      const countdown = setInterval(() => {
        count--;
        if (count > 0) {
          wordElement.textContent = `${count}`;
        } else {
          clearInterval(countdown);
          startGame();
        }
      }, 1000);
    }

    inputElement.addEventListener("input", () => {
      const val = inputElement.value.trim().toLowerCase();
      const expectedChar = currentRomaji[inputIndex];
      if (val === expectedChar) {
        inputIndex++;
        score++;
        scoreElement.textContent = `スコア: ${score}`;
        updateRomajiDisplay();
        inputElement.value = "";
        if (inputIndex === currentRomaji.length) {
          displayWord();
        }
      } else {
        document.body.style.backgroundColor = "#ff4444";
        setTimeout(() => {
          document.body.style.backgroundColor = "#222";
        }, 150);
        inputElement.value = "";
      }
    });

    startBtn.addEventListener("click", startCountdownAndGame);

    document.addEventListener("keydown", e => {
      if (e.code === "Space") {
        e.preventDefault();
        startCountdownAndGame();
      }
    });

    wordElement.textContent = "スタートを押してね！";
    romajiElement.textContent = "";
    highScoreElement.textContent = `最高記録: ${highScore}`;
  </script>
</body>
</html>
